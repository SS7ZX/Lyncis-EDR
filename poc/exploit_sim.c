#include <sys/mman.h>
#include <stdio.h>
#include <unistd.h>

int main() {
    size_t size = 4096;
    void* addr = mmap(NULL, size, PROT_READ | PROT_WRITE, MAP_ANONYMOUS | MAP_PRIVATE, -1, 0);

    printf("[*] ATTACK START: Attempting RWX transition...\n");
    
    if (mprotect(addr, size, PROT_READ | PROT_WRITE | PROT_EXEC) == -1) {
        perror("[!] Lyncis VETO: Kernel denied memory permission");
        printf("[*] STASIS: Holding process for forensic carving (5s)...\n");
        sleep(5); 
    } else {
        printf("[?] SUCCESS: System is vulnerable!\n");
    }
    return 0;
}
